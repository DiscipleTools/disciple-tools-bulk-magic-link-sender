import{L as t,x as e,i as s,y as i}from"../../lit-element-3e2a69ab.js";import{D as o,A as r,m as l,s as n}from"../../dt-base.js";import{o as a}from"../../map-c0e24c36.js";import{e as d,i as c,t as p}from"../../directive-de55b00a.js";import{l as h}from"../../if-defined-49a407ec.js";import{o as u}from"../../class-map-7c49ce6b.js";import"../../icons/dt-star.js";
/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{I:m}=t,g=()=>document.createComment(""),f=(t,e,s)=>{var i;const o=t._$AA.parentNode,r=void 0===e?t._$AB:e._$AA;if(void 0===s){const e=o.insertBefore(g(),r),i=o.insertBefore(g(),r);s=new m(e,i,t,t.options)}else{const e=s._$AB.nextSibling,l=s._$AM,n=l!==t;if(n){let e;null===(i=s._$AQ)||void 0===i||i.call(s,t),s._$AM=t,void 0!==s._$AP&&(e=t._$AU)!==l._$AU&&s._$AP(e)}if(e!==r||n){let t=s._$AA;for(;t!==e;){const e=t.nextSibling;o.insertBefore(t,r),t=e}}}return s},b=(t,e,s=t)=>(t._$AI(e,s),t),y={},v=t=>{var e;null===(e=t._$AP)||void 0===e||e.call(t,!1,!0);let s=t._$AA;const i=t._$AB.nextSibling;for(;s!==i;){const t=s.nextSibling;s.remove(),s=t}},_=(t,e,s)=>{const i=new Map;for(let o=e;o<=s;o++)i.set(t[o],o);return i},k=d(class extends c{constructor(t){if(super(t),t.type!==p.CHILD)throw Error("repeat() can only be used in text expressions")}ht(t,e,s){let i;void 0===s?s=e:void 0!==e&&(i=e);const o=[],r=[];let l=0;for(const e of t)o[l]=i?i(e,l):l,r[l]=s(e,l),l++;return{values:r,keys:o}}render(t,e,s){return this.ht(t,e,s).values}update(t,[s,i,o]){var r;const l=(t=>t._$AH)(t),{values:n,keys:a}=this.ht(s,i,o);if(!Array.isArray(l))return this.ut=a,n;const d=null!==(r=this.ut)&&void 0!==r?r:this.ut=[],c=[];let p,h,u=0,m=l.length-1,g=0,k=n.length-1;for(;u<=m&&g<=k;)if(null===l[u])u++;else if(null===l[m])m--;else if(d[u]===a[g])c[g]=b(l[u],n[g]),u++,g++;else if(d[m]===a[k])c[k]=b(l[m],n[k]),m--,k--;else if(d[u]===a[k])c[k]=b(l[u],n[k]),f(t,c[k+1],l[u]),u++,k--;else if(d[m]===a[g])c[g]=b(l[m],n[g]),f(t,l[u],l[m]),m--,g++;else if(void 0===p&&(p=_(a,g,k),h=_(d,u,m)),p.has(d[u]))if(p.has(d[m])){const e=h.get(a[g]),s=void 0!==e?l[e]:null;if(null===s){const e=f(t,l[u]);b(e,n[g]),c[g]=e}else c[g]=b(s,n[g]),f(t,l[u],s),l[e]=null;g++}else v(l[m]),m--;else v(l[u]),u++;for(;g<=k;){const e=f(t,c[k+1]);b(e,n[g]),c[g++]=e}for(;u<=m;){const t=l[u++];null!==t&&v(t)}return this.ut=a,((t,e=y)=>{t._$AH=e})(t,c),e}});
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */window.customElements.define("dt-list",class extends o{static get styles(){return s`:host{--number-of-columns:7;font-family:var(--dt-list-font-family,var(--font-family));font-size:var(--dt-list-font-size,15px);font-weight:var(--dt-list-font-weight,300);line-height:var(--dt-list-line-height,1.5);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.section{container-type:inline-size;background-color:var(--dt-list-background-color,#fefefe);border:1px solid var(--dt-list-border-color,#f1f1f1);border-radius:var(--dt-list-border-radius,10px);box-shadow:var(--dt-list-box-shadow,0 2px 4px rgb(0 0 0 / 25%));padding:var(--dt-list-section-padding,1rem)}.header{display:flex;justify-content:flex-start;align-items:baseline;gap:var(--dt-list-header-gap,1.5em);flex-wrap:wrap}.section-header{color:var(--dt-list-header-color,var(--primary-color));font-size:1.5rem;display:inline-block;text-transform:capitalize}.toggleButton{color:var(--dt-list-header-color,var(--primary-color));font-size:1rem;background:0 0;border:var(--dt-list-toggleButton,.1em solid rgb(0 0 0 / .2));border-radius:.25em;padding:.25em .5em;cursor:pointer}.toggleButton svg{height:.9rem;transform:translateY(-2px);vertical-align:bottom;width:1rem;fill:var(--dt-list-header-color,var(--primary-color));stroke:var(--dt-list-header-color,var(--primary-color))}.list_action_section{background-color:var(--dt-list-action-section-background-color,#ecf5fc);border-radius:var(--dt-list-border-radius,10px);margin:var(--dt-list-action-section-margin,30px 0);padding:var(--dt-list-action-section-padding,20px)}.list_action_section_header{display:flex;flex-direction:row;justify-content:space-between}.close-button{outline:0;font-size:2.5em;line-height:1;color:var(--dt-list-action-close-button,var(--inactive-color));background:0 0;border:none;cursor:pointer}.fieldsList{list-style-type:none;column-count:1}.list-field-picker-item{list-style-type:none}.list-field-picker-item input{margin:1rem}.list-field-picker-item .dt-icon{height:var(--dt-list-field-picker-icon-size,1rem);width:var(--dt-list-field-picker-icon-size,1rem)}table{display:grid;border:1px solid var(--dt-list-border-color,#f1f1f1);border-top:0;border-collapse:collapse;min-width:100%;grid-template-columns:minmax(32px,.1fr) minmax(32px,.1fr) minmax(50px,.8fr)}table td:last-child{border-bottom:1px solid var(--dt-list-border-color,#f1f1f1);padding-bottom:2rem}tbody,thead,tr{display:contents}tr{cursor:pointer}tr:nth-child(2n + 1){background:#f1f1f1}tr:hover{background-color:var(--dt-list-hover-background-color,#ecf5fc)}tr a{color:var(--dt-list-link-color,var(--primary-color))}th{display:none}.column-name{pointer-events:none}#sort-arrows{grid-template-columns:4fr 1fr;display:flex;flex-direction:column;height:1.5em;justify-content:space-evenly}th.all span.sort-arrow-up{border-color:transparent transparent var(--dt-list-sort-arrow-color,grey) transparent;border-style:solid;border-width:0 .5em .5em .5em}th.all span.sort-arrow-down{content:'';border-color:var(--dt-list-sort-arrow-color,grey) transparent transparent;border-style:solid;border-width:.5em .5em 0}th.all span.sort-arrow-up.sortedBy{border-color:transparent transparent var(--dt-list-sort-arrow-color-highlight,#999) transparent}th.all span.sort-arrow-down.sortedBy{border-color:var(--dt-list-sort-arrow-color-highlight,#999) transparent transparent}td{border:0;grid-column:1/span 3;padding-inline-start:1em}td::before{content:attr(title) ': ';padding-inline-end:1em}td.no-title{grid-column:auto}td.line-count{padding-block-start:.8em;padding-inline-start:1em}td.bulk_edit_checkbox{grid-column:1/auto}td.no-title::before{content:'';padding-inline-end:.25em}td.bulk_edit_checkbox,th.bulk_edit_checkbox{grid-column:none}.bulk_edit_checkbox input{display:none}.bulk_editing td.bulk_edit_checkbox,.bulk_editing th.bulk_edit_checkbox{grid-column:1/auto}.bulk_editing .bulk_edit_checkbox input{display:initial}ul{margin:0;padding:0}ul li{list-style-type:none}input[type=checkbox]{margin:1rem}table{grid-template-columns:minmax(32px,.5fr) minmax(32px,.5fr) minmax(32px,.5fr) repeat(var(--number-of-columns,7),minmax(50px,1fr))}th{position:sticky;top:0;background:var(--dt-list-header-background-color,var(--dt-tile-background-color,#fefefe));text-align:start;justify-self:start;font-weight:400;font-size:1.1rem;color:var(--dt-list-header-color,#0a0a0a);white-space:pre-wrap;display:grid;place-items:center;grid-template-columns:2fr 1fr}th:last-child{border:0}td{display:flex;align-items:center;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding-top:.5rem;padding-bottom:.5rem;padding-inline-start:0;color:var(--text-color-mid);border-bottom:1px solid var(--dt-list-border-color,#f1f1f1);grid-column:auto}td::before{content:'';display:none}`}static get properties(){return{postType:{type:String},postTypeLabel:{type:String},postTypeSettings:{type:Object,attribute:!0},posts:{type:Array},total:{type:Number},columns:{type:Array},sortedBy:{type:String},loading:{type:Boolean,default:!0},offset:{type:Number},showArchived:{type:Boolean,default:!1},showFieldsSelector:{type:Boolean,default:!1},showBulkEditSelector:{type:Boolean,default:!1},nonce:{type:String}}}constructor(){super(),this.sortedBy="name"}firstUpdated(){this.nonce&&!this.api&&(this.api=new r(this.nonce))}async _getPosts(t=0,e="name",s="desc"){this.loading=!0,this.filteredOptions=[];const i=encodeURI(`?offset=${t}&sortBy=${`${"desc"===s?"-":""}${e}`}&offset=${t}${this.columns.map((t=>`&fields_to_return=${t}`)).join("")}`);return await this.api.makeRequestOnPosts("GET",`${this.postType}${i}`)}_headerClick(t){const e=t.target.dataset.id;this._getPosts(this.offset?this.offset:0,e).then((t=>{this.posts=t,this.sortedBy=e}))}_bulkEdit(){this.showBulkEditSelector=!this.showBulkEditSelector}_fieldsEdit(){this.showFieldsSelector=!this.showFieldsSelector}_toggleShowArchived(){this.showArchived=!this.showArchived}_sortArrowsClass(t){return this.sortedBy===t?"sortedBy":""}_sortArrowsToggle(t){return this.sortedBy!==`-${t}`?`-${t}`:t}_headerTemplate(){return i`<thead><tr><th id="bulk_edit_master" class="bulk_edit_checkbox"><input type="checkbox" name="bulk_send_app_id" id="bulk_edit_master_checkbox"></th><th></th>${a(this.columns,(t=>i`<th class="all" data-id="${this._sortArrowsToggle(t)}" @click="${this._headerClick}"><span class="column-name">${this.postTypeSettings[t].name}</span> <span id="sort-arrows"><span class="sort-arrow-up ${this._sortArrowsClass(`-${t}`)}" data-id="-${t}"></span> <span class="sort-arrow-down ${this._sortArrowsClass(t)}" data-id="${t}"></span></span></th>`))}</tr></thead>`}_rowTemplate(){return a(this.posts,((t,e)=>this.showArchived||!this.showArchived&&"closed"!==t.overall_status.key?i`<tr class="dnd-moved" data-link="${this.posts.permalink}"><td class="bulk_edit_checkbox no-title"><input type="checkbox" name="bulk_edit_id" .value="${t.ID}"></td><td class="no-title line-count">${e+1}.</td>${this._cellTemplate(t)}</tr>`:null))}_cellTemplate(t){return a(this.columns,(e=>{if(["text","textarea","number"].includes(this.postTypeSettings[e].type))return i`<td dir="auto" title="${this.postTypeSettings[e].name}"><a href="${t[e]}" title="test">${t[e]}</a></td>`;if("date"===this.postTypeSettings[e].type)return i`<td dir="auto" title="${this.postTypeSettings[e].name}">${t[e].formatted}</td>`;if("user_select"===this.postTypeSettings[e].type&&t[e]&&t[e].display)return i`<td dir="auto" title="${this.postTypeSettings[e].name}">${h(t[e].display)}</td>`;if("key_select"===this.postTypeSettings[e].type&&t[e]&&(t[e].label||t[e].name))return i`<td dir="auto" title="${this.postTypeSettings[e].name}">${t[e].label||t[e].name}</td>`;if("multi_select"===this.postTypeSettings[e].type||"tags"===this.postTypeSettings[e].type&&t[e]&&t[e].length>0)return i`<td dir="auto" title="${this.postTypeSettings[e].name}"><ul>${a(t[e],(t=>i`<li>${this.postTypeSettings[e].default[t].label}</li>`))}</ul></td>`;if("location"===this.postTypeSettings[e].type||"location_meta"===this.postTypeSettings[e].type)return i`<td dir="auto" title="${this.postTypeSettings[e].name}">${h(t[e].label)}</td>`;if("communication_channel"===this.postTypeSettings[e].type)return i`<td dir="auto" title="${this.postTypeSettings[e].name}">${h(t[e].value)}</td>`;if("connection"===this.postTypeSettings[e].type)return i`<td dir="auto" title="${this.postTypeSettings[e].name}">${h(t[e].value)}</td>`;if("boolean"===this.postTypeSettings[e].type){if("favorite"===e)return i`<td dir="auto" title="${this.postTypeSettings[e].name}"><dt-star postID="${t.ID}" ?selected="${t.favorite}"></dt-star></td>`;if(!0===this.postTypeSettings[e])return i`<td dir="auto" title="${this.postTypeSettings[e].name}">['✓']</td>`}return i`<td dir="auto" title="${this.postTypeSettings[e].name}"></td>`}))}_fieldListIconTemplate(t){return this.postTypeSettings[t].icon?i`<img class="dt-icon" src="${this.postTypeSettings[t].icon}" alt="${this.postTypeSettings[t].name}">`:null}_fieldsListTemplate(){return k(Object.keys(this.postTypeSettings).sort(((t,e)=>{const s=this.postTypeSettings[t].name.toUpperCase(),i=this.postTypeSettings[e].name.toUpperCase();return s<i?-1:s>i?1:0})),(t=>t),(t=>this.postTypeSettings[t].hidden?null:i`<li class="list-field-picker-item"><label><input type="checkbox" id="${t}" name="${t}" .value="${t}" @change="${this._updateFields}" ?checked="${this.columns.includes(t)}"> ${this._fieldListIconTemplate(t)} ${this.postTypeSettings[t].name}</label></li>`))}_fieldsSelectorTemplate(){return this.showFieldsSelector?i`<div id="list_column_picker" class="list_field_picker list_action_section"><div class="list_action_section_header"><p style="font-weight:700">${l("Choose which fields to display as columns in the list")}</p><button class="close-button list-action-close-button" data-close="list_column_picker" aria-label="Close modal" type="button" @click="${this._fieldsEdit}"><span aria-hidden="true">×</span></button></div><ul class="fieldsList">${this._fieldsListTemplate()}</ul></div>`:null}_updateFields(t){const e=t.target.value,s=this.columns;s.includes(e)?(s.filter((t=>t!==e)),s.splice(s.indexOf(e),1)):s.push(e),this.columns=s,this.style.setProperty("--number-of-columns",this.columns.length-1),this.requestUpdate()}_bulkSelectorTemplate(){return this.showBulkEditSelector?i`<div id="bulk_edit_picker" class="list_action_section"><div class="list_action_section_header"><p style="font-weight:700">${l(n`Select all the ${this.postType} you want to update from the list, and update them below`)}</p><button class="close-button list-action-close-button" aria-label="Close modal" type="button" @click="${this._bulkEdit}"><span aria-hidden="true">×</span></button></div><ul class="fieldsList">${l("This is where the bulk edit form will go.")}</ul></div>`:null}connectedCallback(){super.connectedCallback(),this.posts||this._getPosts().then((t=>{this.posts=t}))}render(){const t={bulk_editing:this.showBulkEditSelector,hidden:!1},e=i`<svg viewBox="0 0 100 100" fill="#000000" style="enable-background:new 0 0 100 100" xmlns="http://www.w3.org/2000/svg"><line style="stroke-linecap:round;paint-order:fill;fill:none;stroke-width:15px" x1="7.97" y1="50.199" x2="76.069" y2="50.128" transform="matrix(0.999999, 0.001017, -0.001017, 0.999999, 0.051038, -0.042708)"/><line style="stroke-linecap:round;stroke-width:15px" x1="7.97" y1="17.751" x2="92.058" y2="17.751"/><line style="stroke-linecap:round;stroke-width:15px" x1="7.97" y1="82.853" x2="42.343" y2="82.853"/><polygon style="stroke-linecap:round;stroke-miterlimit:1;stroke-linejoin:round;fill:#fff;paint-order:stroke;stroke-width:9px" points="22.982 64.982 33.592 53.186 50.916 70.608 82.902 21.308 95 30.85 52.256 95"/></svg>`,s=i`<svg height="100px" width="100px" fill="#000000" xmlns:x="http://ns.adobe.com/Extensibility/1.0/" xmlns:i="http://ns.adobe.com/AdobeIllustrator/10.0/" xmlns:graph="http://ns.adobe.com/Graphs/1.0/" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve"><g><g i:extraneous="self"><g><path d="M94.4,63c0-5.7-3.6-10.5-8.6-12.5V7.3c0-2.7-2.2-4.8-4.8-4.8c-2.7,0-4.8,2.2-4.8,4.8v43.2c-5,1.9-8.6,6.8-8.6,12.5     s3.6,10.5,8.6,12.5v17.2c0,2.7,2.2,4.8,4.8,4.8c2.7,0,4.8-2.2,4.8-4.8V75.5C90.9,73.6,94.4,68.7,94.4,63z M81,66.7     c-2,0-3.7-1.7-3.7-3.7c0-2,1.7-3.7,3.7-3.7s3.7,1.7,3.7,3.7C84.7,65.1,83.1,66.7,81,66.7z"></path><path d="M54.8,24.5V7.3c0-2.7-2.2-4.8-4.8-4.8c-2.7,0-4.8,2.2-4.8,4.8v17.2c-5,1.9-8.6,6.8-8.6,12.5s3.6,10.5,8.6,12.5v43.2     c0,2.7,2.2,4.8,4.8,4.8c2.7,0,4.8-2.2,4.8-4.8V49.5c5-1.9,8.6-6.8,8.6-12.5S59.8,26.5,54.8,24.5z M50,40.7c-2,0-3.7-1.7-3.7-3.7     c0-2,1.7-3.7,3.7-3.7c2,0,3.7,1.7,3.7,3.7C53.7,39.1,52,40.7,50,40.7z"></path><path d="M23.8,50.5V7.3c0-2.7-2.2-4.8-4.8-4.8c-2.7,0-4.8,2.2-4.8,4.8v43.2c-5,1.9-8.6,6.8-8.6,12.5s3.6,10.5,8.6,12.5v17.2     c0,2.7,2.2,4.8,4.8,4.8c2.7,0,4.8-2.2,4.8-4.8V75.5c5-1.9,8.6-6.8,8.6-12.5S28.8,52.5,23.8,50.5z M19,66.7c-2,0-3.7-1.7-3.7-3.7     c0-2,1.7-3.7,3.7-3.7c2,0,3.7,1.7,3.7,3.7C22.7,65.1,21,66.7,19,66.7z"></path></g></g></g></svg>`;return i`<div class="section"><div class="header"><div class="section-header"><span class="section-header posts-header" style="display:inline-block">${l(n`${this.postTypeLabel?this.postTypeLabel:this.postType} List`)}</span></div><span class="filter-result-text">${l(n`Showing 1 of ${this.total}`)}</span> <button class="bulkToggle toggleButton" id="bulk_edit_button" @click="${this._bulkEdit}">${e} ${l("Bulk Edit")}</button> <button class="fieldsToggle toggleButton" id="fields_edit_button" @click="${this._fieldsEdit}">${s} ${l("Fields")}</button><dt-toggle name="showArchived" label="${l("Show Archived")}" ?checked="${this.showArchived}" hideIcons onchange="${this._toggleShowArchived}" @click="${this._toggleShowArchived}"></dt-toggle></div>${this._fieldsSelectorTemplate()} ${this._bulkSelectorTemplate()}<table class="${u(t)}">${this._headerTemplate()} ${this.posts?this._rowTemplate():l("Loading")}</table></div>`}});
